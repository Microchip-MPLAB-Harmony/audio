<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN">
<html>
<head>
<title>DSP_FilterFIRDecim32 Function</title>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="generator" content="Doc-O-Matic" />
    <meta http-equiv="Content-Style-Type" content="text/css" />
    <link rel="STYLESHEET" href="default.css" type="text/css" />

<script type="text/javascript" src="scripts.js"></script>
</head>
<body class="Element700" onload="onBodyLoadEx('frames.html', 'topic', '00443.html');" onmousedown="onBodyMouseDown();">

<!-- Begin Popups -->

<!-- End Popups -->

<!-- Begin Page Header -->
<div class="Element710" id="areafixed">
<div class="Element94">
<a href="00651.html" target="topic">Math Libraries Help</a> &gt; <a href="00638.html" target="topic">DSP</a> &gt; <a href="00648.html" target="topic">Library Interface</a> &gt; Functions &gt; <a href="00443.html" target="topic">DSP_FilterFIRDecim32 Function</a></div>
<div class="Element92">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element1">
MPLAB Harmony Audio Help</div>
</td><td width="25%">
<div class="Element2">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00158.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element90">
<a href="00442.html" target="topic">Previous</a> | <a href="00648.html" target="topic">Up</a> | <a href="00444.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element96">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DSP_FilterFIRDecim32@int32_t *@int32_t *@int32_t *@int32_t *@int@int@int@int Topic Title: DSP_FilterFIRDecim32 Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table><div class="Element5">
DSP_FilterFIRDecim32 Function</div>
</div>
</div>

<!-- End Page Header -->

<!-- Begin Client Area -->
<div class="Element720" id="areascroll">
<div class="Element721">

<!-- Begin Page Content -->
<a name="PageContent"></a><div class="Element58">
<a name="53756D6D617279"></a><div class="Element11">
<div class="Element10">
<p class="Element10">
Performs a decimating FIR filter on the input array.</p></div>
</div>
<a name="4465736372697074696F6E"></a><div class="Element14">
Description</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
Function DSP_FilterFIRDecim32:&nbsp;</p>
<p class="Element10">
void DSP_FilterFIRDecim32(int32_t *outdata, int32_t *indata, int32_t *coeffs, int32_t *delayline, int N, int K, int scale, int rate);&nbsp;</p>
<p class="Element10">
Compute a FIR decimation filter on the input vector indata, and store the results to the vector outdata. The total number of output elements is set by N, and therefore the outdata array must be at least N in length. The decimation ratio is given by rate. The input is sampled every integer value of rate, skipping every (rate-1) input samples. The input array must therefore be (rate*N) samples long. The amount of filter taps is specified by K. Coeffs specifies the coefficients array. The delayline array holds delay inputs for calculation, and must be initialized to zero prior to calling the filter. Both coeffs and delayline must be K in length. Scale divides the input by a scaling factor by right shifting the number of bits (1/2^scale). All values of input, output, and coeffs are given in Q31 fractional data format. The function will saturate if the output value exceeds the maximum or minimum value.&nbsp;</p>
<p class="Element10">
Y = b0 * X0 + (b1 * X(-1)) + (b2 * X(-2)</p></div>
</div>
<a name="507265636F6E646974696F6E73"></a><div class="Element14">
Preconditions</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
The pointers outdata and indata must be aligned on 4-byte boundaries. delayline must have K elements, and be initialized to zero. coeffs must have K elements. outdata must have N elements indata must have (N*rate) elements</p></div>
</div>
<a name="506172616D6574657273"></a><div class="Element14">
Parameters</div>
<div class="Element11">
<div class="Element10">
<div class="Element312">
<div class="TableDiv">
<table cellspacing="0" class="Table3">
<tr>
<td class="Element300" valign="top" width="35%">
<div class="Element301">
Parameters&nbsp;</div></td><td class="Element304" valign="top" width="65%">
<div class="Element305">
Description&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
outdata&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
pointer to output array of elements (int32_t)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
indata&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
pointer to input array of elements (int32_t)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
coeffs&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
pointer to an array of coefficients (int32_t)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
delayline&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
pointer to an array of delay variables (int32_t)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
N&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
number of output elements to be processed (int)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
K&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
number of filter taps and coeffs (int)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
scale&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
binary scaler divisor (1 / 2^scale) (int)&nbsp;</div></td></tr><tr>
<td class="Element302" valign="top" width="35%">
<div class="Element303">
rate&nbsp;</div></td><td class="Element306" valign="top" width="65%">
<div class="Element307">
decimation ratio (int)&nbsp;</div></td></tr></table></div></div>
</div>
</div>
<a name="52657475726E73"></a><div class="Element14">
Returns</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
None.</p></div>
</div>
<a name="4578616D706C65"></a><div class="Element14">
Example</div>
<div class="Element11">
<div class="Element10">
<div class="Element13"><div class="Element12"><pre class="Element12">
<strong><span style="color: #000080">#define</span></strong> N 8         <i><span style="color: #008000">// number of output samples</span></i>
<strong><span style="color: #000080">#define</span></strong> TAPS 5
<strong><span style="color: #000080">#define</span></strong> SKIP 3

<strong><span style="color: #000080">int</span></strong> testFilterN = N;        <i><span style="color: #008000">// number of output elements</span></i>
<strong><span style="color: #000080">int</span></strong> testFilterK = TAPS;     <i><span style="color: #008000">// number of taps</span></i>
<strong><span style="color: #000080">int</span></strong> testFilterRate = SKIP;  <i><span style="color: #008000">// decimation rate R</span></i>
int32_t outFiltDataDec[N]={0};
int32_t *inTestFilter[N*SKIP];
<strong><span style="color: #000080">int</span></strong> filtScaleNum = 1;       <i><span style="color: #008000">// scale output (1 /2^n) =&gt; Y * 0.5</span></i>

int32_t filtDelayTest[8]={0};  <i><span style="color: #008000">// always initialize to zero</span></i>

<i><span style="color: #008000">// get pointer to input buffer here //</span></i>
inTestFilter = &amp;inputBuffer;

DSP_FilterFIRDecim32(outFiltDataDec, inTestFilter, inTestCoefs,
        filtDelayTest, testFilterN, testFilterK, filtScaleNum, testFilterRate);
</pre></div></div>
</div>
</div>
<a name="52656D61726B73"></a><div class="Element14">
Remarks</div>
<div class="Element11">
<div class="Element10">
<p class="Element10">
Coefs are loaded into the array with corresponding to the least delay first (C0, C(-1), C(-2)). K must be greater than rate. Even while decimating the input stream, every input passes through the delayline. So FIR filters of arbitrary length will give the same output as a non-decimating FIR, just with fewer responses.</p></div>
</div>
<a name="43"></a><div class="Element99">
C</div>
<div class="Element101"><div class="Element100"><pre class="Element100"><strong><span style="color: #000080">void</span></strong> <strong><span style="color: #000000">DSP_FilterFIRDecim32</span></strong>(
    int32_t * <strong><span style="color: #000000">outdata</span></strong>, 
    int32_t * <strong><span style="color: #000000">indata</span></strong>, 
    int32_t * <strong><span style="color: #000000">coeffs</span></strong>, 
    int32_t * <strong><span style="color: #000000">delayline</span></strong>, 
    <strong><span style="color: #000080">int</span></strong> <strong><span style="color: #000000">N</span></strong>, 
    <strong><span style="color: #000080">int</span></strong> <strong><span style="color: #000000">K</span></strong>, 
    <strong><span style="color: #000080">int</span></strong> <strong><span style="color: #000000">scale</span></strong>, 
    <strong><span style="color: #000080">int</span></strong> <strong><span style="color: #000000">rate</span></strong>
);</pre></div></div>
</div>
<!-- End Page Content -->

<!-- Begin Page Footer -->
<div class="Element95">
<a href="00651.html" target="topic">Math Libraries Help</a> &gt; <a href="00638.html" target="topic">DSP</a> &gt; <a href="00648.html" target="topic">Library Interface</a> &gt; Functions &gt; <a href="00443.html" target="topic">DSP_FilterFIRDecim32 Function</a></div>
<div class="Element93">
<table width="100%" cellspacing="0" cellpadding="0">
<tr><td width="25%">
<div class="Element3">
MPLAB Harmony Audio Help</div>
</td><td width="25%">
<div class="Element4">
<a href="contents.html" target="tocidx">Contents</a> | <a href="00158.html" target="topic">Home</a></div>
</td><td width="25%">
<div class="Element91">
<a href="00442.html" target="topic">Previous</a> | <a href="00648.html" target="topic">Up</a> | <a href="00444.html" target="topic">Next</a></div>
</td><td width="25%">
<div class="Element97">
<a href="mailto:docerrors@microchip.com&subject=MPLAB Harmony Documentation Feedback (Topic ID: DSP_FilterFIRDecim32@int32_t *@int32_t *@int32_t *@int32_t *@int@int@int@int Topic Title: DSP_FilterFIRDecim32 Function)&body=Thank you for your feedback! Please include a description of your feedback, and indicate whether you are reporting an an error in the documentation or an enhancement.">Documentation Feedback</a><br> <a href="http://support.microchip.com" target="_blank">Microchip Support</a></div>
</td></tr></table></div>

<!-- End Page Footer -->
</div>
</div>

<!-- End Client Area -->
</body></html>